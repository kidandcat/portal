{{template "layout" .}}
{{define "content"}}
<div class="auth-page">
    <div class="auth-card">
        <div class="auth-logo">Portal</div>
        <div class="auth-success">
            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="#0d5c84" stroke-width="2"><path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z"/></svg>
            <h2>Revisa tu email</h2>
            <p>Hemos enviado un enlace mágico a <strong>{{.Email}}</strong></p>
            <p class="text-muted">Haz clic en el enlace del email para iniciar sesión. Caduca en 15 minutos.</p>
        </div>
        <a href="/login" class="btn btn-secondary btn-full">Volver al inicio de sesión</a>
    </div>
</div>
<script>
(function() {
    var token = "{{.Token}}";
    if (!token) return;
    var interval = setInterval(function() {
        fetch("/auth/status?token=" + encodeURIComponent(token))
            .then(function(r) { return r.json(); })
            .then(function(data) {
                if (data.approved) {
                    clearInterval(interval);
                    window.location.href = "/dashboard";
                }
            })
            .catch(function() {});
    }, 2000);
})();
</script>
{{end}}
